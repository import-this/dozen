!function(e,t,n,o){"use strict";function i(t){this.localStorage=t||e.localStorage,+this.load(y.VERSION)!==w&&this._upgrade(this.load(y.VERSION))}function a(e,t){return void 0===t.speed&&(t.speed=""),void 0===t.size&&(t.size=i._size),e+"_"+t.mode+"_"+t.speed+"_"+t.size.rows+"x"+t.size.cols}function r(e){var t,n,o;for(t=e.length-1;t>0;--t)n=Math.floor(Math.random()*(t+1)),o=e[t],e[t]=e[n],e[n]=o}function s(e){return e>0&&0==(e&e-1)}function c(e,t){return e+"-"+t}function u(e,t){return"#c-"+e+"-"+t}function l(e,t){return n(u(e,t)).position()}function f(e){return e>=4&&s(e)?e>=128?128:4:e%12==0?e>=192?192:12:e}function d(e){return"n"+f(e)}function h(e){return e>0&&e%12==0}function p(e){for(var t=0,n=e.length;t<n;++t)if(e[t]!==e[0])return!1;return!0}function m(e){return e.every(h)&&p(e)}function g(e,t,n,i,a){o(C(e[0],l(t,n),i,a))}function v(e,t,n){e[0].style[b]=O(l(t,n))}function T(e,t){var n=e.find(".number"),o=+n.text()||1;return e.removeClass(d(o)).addClass(d(t)),n.text(t),e}var A=function(){Function.prototype.apply.call(console.log,console,arguments)},S=function(){Function.prototype.apply.call(console.warn,console,arguments)};Math.trunc||(S('Undefined "Math.trunc". Using polyfill.'),Math.trunc=function(e){return e>0?Math.floor(e):Math.ceil(e)}),Array.prototype.fill||(S('Undefined "Array.prototype.fill". Using bad polyfill!'),Object.defineProperty(Array.prototype,"fill",{value:function(e){for(var t=0;t<this.length;++t)this[t]=e;return this}}));var w=0,y=Object.freeze({VERSION:"dozen_version",SETTINGS:"dozen_settings",GRID:"dozen_grid",TILES:"dozen_tiles",STATS:"dozen_stats",RNG:"dozen_rng",APP_STATE:"dozen_app_state",TIMES_PLAYED:"dozen_times_played",HAS_LIKED:"dozen_has_liked"}),E=Object.freeze({CLEAN:0,DIRTY:1,FILTHY:2,EVIL:3}),N=Object.freeze({CLASSIC:0,SLOW:1,PRACTICE:2,FAST:3}),I=Object.freeze({VSHORT:0,SHORT:1,NORMAL:2,LONG:3,VLONG:4});i.prototype._upgrade=function(e){this.save(y.VERSION,w)},i._size={rows:"",cols:""},i.prototype.save=function(e,t){this.localStorage.setItem(e,t)},i.prototype.load=function(e){return this.localStorage.getItem(e)},i.prototype.saveGrid=function(e,t){this.save(a(y.GRID,e),JSON.stringify(t))},i.prototype.loadGrid=function(e){return JSON.parse(this.load(a(y.GRID,e)))},i.prototype.saveTiles=function(e,t,n,o,i){this.save(a(y.TILES,e),JSON.stringify({tile:t,next:n,row:o,col:i}))},i.prototype.loadTiles=function(e){return JSON.parse(this.load(a(y.TILES,e)))},i.prototype.saveRngState=function(e,t){this.save(a(y.RNG,e),JSON.stringify(t))},i.prototype.loadRngState=function(e){return JSON.parse(this.load(a(y.RNG,e)))},i.prototype.saveStats=function(e,t){this.save(a(y.STATS,e),JSON.stringify(t))},i.prototype.loadStats=function(e){return JSON.parse(this.load(a(y.STATS,e)))},i.prototype.hasSavedGame=function(e){return null!==this.load(a(y.TILES,e))},i.prototype.saveAppState=function(e){this.save(y.APP_STATE,JSON.stringify({mode:e}))},i.prototype.loadAppState=function(){return JSON.parse(this.load(y.APP_STATE))},i.prototype.clearAppState=function(){this.localStorage.removeItem(y.APP_STATE)},i.prototype.saveSettings=function(e){this.save(y.SETTINGS,JSON.stringify(e))},i.prototype.loadSettings=function(){return JSON.parse(this.load(y.SETTINGS))},i.prototype.incTimesPlayed=function(e){this.save(y.TIMES_PLAYED+"_"+e.mode,this.loadTimesPlayed(e)+1)},i.prototype.loadTimesPlayed=function(e){return+this.load(y.TIMES_PLAYED+"_"+e.mode)},i.prototype.loadTotalTimesPlayed=function(){var e=this,t=0;return Object.keys(E).forEach(function(n){t+=+e.load(y.TIMES_PLAYED+"_"+E[n])}),t};var M=new i;A("Dozen - Version:","1.0.0"),A("Welcome! Hope you enjoy! :)\n\n");var L=isAndroidStockBrowser?"tap":"tap click",b=function(e){var n=t.createElement("div").style,o=["ms","Moz","webkit"],i=o.length,a=e[0].toUpperCase()+e.slice(1);if(e in n)return e;for(;i--;)if((e=o[i]+a)in n)return e}("transform"),G=function(){var e=t.createElement("div").style,n=["Moz","webkit"],o=n.length;if("perspective"in e)return!0;for(;o--;)if(n[o]+"Perspective"in e)return!0;return!1}(),O=G?function(e){return"translateX("+e.left+"px) translateY("+e.top+"px) translateZ(0)"}:function(e){return"translateX("+e.left+"px) translateY("+e.top+"px)"},C=function(){var e={targets:null,translateX:0,translateY:0,duration:0,complete:null,easing:"linear"};return G&&(e.translateZ=0),function(t,n,o,i){return e.targets=t,e.translateX=n.left,e.translateY=n.top,e.duration=o,e.complete=i,e}}(),z=function(e,t){function n(){var n=e.find(".tile.transparent");return 0===n.length?t.clone().removeAttr("id").appendTo(e):n.first()}var o={};return{newTile:function(e){return T(n(),e).removeClass("transparent")},newTileAt:function(e,t,o){var i=T(n(),o);return this.add(i,e,t),i.removeClass("transparent")},add:function(e,t,n){o[c(t,n)]=e},get:function(e,t){return o[c(e,t)]},update:function(e,t,n,i){var a=c(e,t);o[c(n,i)]=o[a],delete o[a]},hide:function(e){e.addClass("transparent")},hideAt:function(e,t){var n=c(e,t),i=o[n];return delete o[n],i.addClass("transparent")},hideAll:function(){e.find(".tile").addClass("transparent"),o={}}}}(n("#tile-container"),n("#base-tile")),P=100,D=1e3,Y={CLEAN:[1,2,3,6],DIRTY:[1,2,3,6],FILTHY:[1,2,3,6],EVIL:[1,2,3,4,6]},R=10;!function(){function i(){M.saveSettings(st)}function a(){M.saveGrid($e,et)}function s(){M.saveTiles($e,ot,it,tt,nt)}function c(){setTimeout(i)}function u(){setTimeout(a)}function l(){setTimeout(s)}function f(e,t){e.filter(".selected").removeClass("selected"),e.filter('[data-option="'+t+'"]').addClass("selected")}function d(){function e(){n(this).hide()}Be.text(Qe.score),n("#score-modifier").show().animate("rise","ease",750,e).children().text(at),Qe.best<Qe.score&&(Qe.best=Qe.score,Ze.text(Qe.best),Qe.isNewBest&&(n("#new-high-score").show().animate("alert",2e3,e),Qe.isNewBest=!1)),Qe.score>=(Qe.level+1)*R&&(Qe.level=Math.floor(Qe.score/R),We.text(Qe.level),n("#level-up").show().animate("rise","ease",750,e)),M.saveStats($e,Qe)}function h(){Qe.score+=at,requestAnimationFrame(d)}function p(e,t){switch($e.speed){default:case N.CLASSIC:return e-Qe.level*t;case N.FAST:return e-9*t;case N.SLOW:return e-3*t;case N.PRACTICE:return D}}function A(){var e=$e.size.rows-1,t=6*D/e,n=Math.ceil(250/e);return Math.max(p(t,(t-n)/12),n)}function S(e){vt.targets=e[0],vt.duration=A()/2,ct=o(vt)}function w(e){ct.pause(),e[0].style.opacity=""}function y(e,t){return 0===et[e][t]}function b(e,t){switch($e.mode){case E.CLEAN:return e+t===3||e===t&&e>=3;case E.DIRTY:return e+t===3||e===t&&2!==e;case E.FILTHY:case E.EVIL:return e+t===3||e===t;default:throw new Error("Invalid mode!")}}function O(){var e=et.length-1,t=Math.floor(et[0].length/2),n=et[e][t];return 0===n||b(n,it)}function C(){v(je,tt,nt)}function F(){ut=!1,Tt=setTimeout(fe,A()),u(),l()}function x(){clearTimeout(Tt)}function k(){if(!O())return Pe(),u(),void l();tt=et.length-1,nt=Math.floor(et[0].length/2),ot=it,it=gt.getNext(),T(Ke,it),je&&w(je),S(je=z.newTile(ot)),C(),y(tt,nt)?F():Z()}function _(){et[tt][nt]=ot,z.add(je,tt,nt),k()}function q(){var e,t,n=et.length-1,o=et[0].length;for(t=0;t<o;++t)for(e=0;e<n&&!y(e+1,t);++e)if(b(et[e][t],et[e+1][t])){wt.push({row:e,col:t});break}wt.length>0?Nt():Lt()}function V(e,t){var n=et[e];et[e]=et[t],et[t]=n}function X(){for(var e=It[It.length-1],t=It[0],n=e+1,o=et.length;n<o;++n)V(t++,n);It=[],q()}function H(){var e,t,n,o,i,a=It[It.length-1],r=It[0],s=-1,c=-1;for(t=a+1,o=et.length;t<o;++t){for(n=0,i=et[0].length;n<i;++n)-1!==s&&g(e,s,c,P),y(t,n)||(e=z.get(t,n),z.update(t,n,r,n),s=r,c=n);++r}-1!==s?g(e,s,c,P,X):X()}function U(){at=0,It.forEach(function(e){for(var t=0,n=et[0].length;t<n;++t)z.hideAt(e,t);at+=et[e][0]/12,et[e].fill(0)}),h(),H()}function J(){et[tt][nt]+=ot,St(tt,nt,q)}function j(){w(je),z.hide(je),requestAnimationFrame(J)}function W(){C(),F()}function B(){C(),rt()}function Z(){ut=!0,j()}function K(e,t){g(je,tt,nt,e,t)}function Q(){K(P,_)}function $(){K(P,j)}function ee(){var e;if(w(je),0!==tt&&(y(tt-1,nt)||b(ot,et[tt-1][nt]))){for(e=tt-1;e>=0&&y(e,nt);--e);e<0||!b(ot,et[e][nt])?(tt=e+1,Q()):(tt=e,$())}else _()}function te(){ut||(ut=!0,x(),requestAnimationFrame(ee))}function ne(e,t,n){tt=e,nt=t,n()}function oe(e,t){if(!ut){if(!y(e,t))return b(ot,et[e][t])?(ne(e,t,Z),void x()):void 0;ne(e,t,B)}}function ie(){oe(tt,nt-1)}function ae(){oe(tt,nt+1)}function re(){oe(tt-1,nt)}function se(){ut||0===nt||requestAnimationFrame(ie)}function ce(){ut||nt===et[0].length-1||requestAnimationFrame(ae)}function ue(){ut||0===tt||requestAnimationFrame(re)}function le(){if(Ct!==Ot.PAUSED&&!ut&&!ut){if(0!==tt)return y(tt-1,nt)?(--tt,void W()):b(ot,et[tt-1][nt])?(--tt,void Z()):void _();_()}}function fe(){$e.speed!==N.PRACTICE&&requestAnimationFrame(le)}function de(e){if(Ct===Ot.PLAYING)switch(e.which){case 37:case 65:e.preventDefault(),se();break;case 39:case 68:e.preventDefault(),ce();break;case 40:case 83:e.preventDefault(),ue();break;case 38:case 87:case 32:e.preventDefault(),te()}}function he(){function e(){switch(st.sensitivity){case I.VSHORT:return.6;case I.SHORT:return.8;default:case I.NORMAL:return 1;case I.LONG:return 1.2;case I.VLONG:return 1.4}}function t(){switch(st.sensitivity){case I.VSHORT:return.5;case I.SHORT:return.75;default:case I.NORMAL:return.95;case I.LONG:return 1.1;case I.VLONG:return 1.2}}requestAnimationFrame(function(){var o,i=n("#c-0-0"),a=i.position();o=e(),dt=Math.round(Math.abs(n("#c-0-1").position().left-a.left)*o),ht=Math.round(Math.abs(n("#c-1-0").position().top-a.top)*o),o=t(),pt=Math.round(i.width()*o),mt=Math.round(i.height()*o)})}function pe(){function o(e,t,n){return e+Math.trunc((t-e)/n)*n}function i(e,t,n){var i,a;if((i=Math.abs(e.clientX-d))>t){a=Math.floor(i/t);do{e.clientX<d?se():ce()}while(0!=--a);d=o(d,e.clientX,t)}else if((i=e.clientY-h)>n){a=Math.floor(i/n);do{ue()}while(0!=--a);h=o(h,e.clientY,n)}}function a(e){return e.clientY>5/8*ft?ue:e.clientX<=lt/2?se:ce}function r(){m(),p=setTimeout(r,33.333)}function s(){n("#game-container").on({touchstart:function(e){var t=e.changedTouches[0];e.preventDefault(),e.touches.length>1||Ct===Ot.PLAYING&&(d=Math.round(t.clientX),h=Math.round(t.clientY))},touchmove:function(e){var t=e.changedTouches[0];e.preventDefault(),e.touches.length>1||Ct===Ot.PLAYING&&i(t,pt,mt)},"touchend touchcancel":function(e){e.preventDefault()},doubleTap:function(){Ct===Ot.PLAYING&&te()}})}function c(){n("#game-container").on({touchstart:function(e){e.preventDefault(),e.touches.length>1||Ct===Ot.PLAYING&&(m=a(e.changedTouches[0]),p=setTimeout(r,350),g.start(e.changedTouches[0]))},touchmove:function(e){var t=a(e.changedTouches[0]);e.preventDefault(),e.touches.length>1||Ct===Ot.PLAYING&&(g.handleMove(e.changedTouches[0])?clearTimeout(p):t!==m&&(clearTimeout(p),m=t,r()))},touchend:function(e){e.preventDefault(),e.touches.length>0||Ct===Ot.PLAYING&&(g.handleSwipe(e.changedTouches[0])===g.DOWN?te():m&&m(),clearTimeout(p),m=null)},touchcancel:function(e){e.touches.length>0||(clearTimeout(p),m=null)}})}function u(e){e?c():s()}function l(){n("#game-container").off("touchstart touchmove touchend touchcancel doubleTap")}function f(e){l(),u(e)}he(),n(e).resize(he),n(t).keydown(de),n("#game").on("contextmenu",!1);var d,h;!function(){var e=!1;n("#game-container").on({mousedown:function(t){Ct===Ot.PLAYING&&0===t.button&&(t.preventDefault(),e=!0,d=t.clientX,h=t.clientY)},mousemove:function(t){Ct===Ot.PLAYING&&e&&(t.preventDefault(),i(t,dt,ht))},mouseup:function(t){0===t.button&&(t.preventDefault(),e=!1)},mouseout:function(t){t.target===this&&(e=!1)},dblclick:function(e){Ct===Ot.PLAYING&&0===e.button&&(e.preventDefault(),te())}})}();var p,m,g=function(){function e(){switch(st.sensitivity){case I.VSHORT:return 20;case I.SHORT:return 30;default:case I.NORMAL:return 40;case I.LONG:return 60;case I.VLONG:return 80}}var t=0,n=0,o=0,i=0,a=0,r={LEFT:0,RIGHT:1,UP:2,DOWN:3,durationThreshold:550,start:function(e){t=Date.now(),n=Math.round(e.clientX),o=Math.round(e.clientY)},handleMove:function(i){var a,s,c=e();return a=Math.abs(i.clientX-n),s=Math.abs(i.clientY-o),Date.now()-t<r.durationThreshold&&(a>c&&s<c||s>c&&a<c)},handleSwipe:function(s){var c,u,l=e();if(i=s.clientX-n,a=s.clientY-o,c=Math.abs(i),u=Math.abs(a),Date.now()-t<r.durationThreshold){if(c>l&&u<l)return i<0?r.LEFT:r.RIGHT;if(u>l&&c<l)return a<0?r.UP:r.DOWN}}};return r}();u(st.altControls),n("#controls").on("change","input",function(){f(parseInt(n("#controls input:checked").val(),10))})}function me(){n(e).off("resize",he),n(t).off("keydown",de),n("#game-container").off(),n("#game").off("contextmenu"),n("#controls").off("change")}function ge(e,t){n("#grid, #tile-container").addClass(e),setTimeout(function(){requestAnimationFrame(function(){n("#grid, #tile-container").removeClass(e),t()})},750+1e3/60)}function ve(){var e;n("#grid .row, #grid .cell").addClass("hidden"),e=new Array($e.size.rows).fill(0).map(function(e,t){return".r"+t}).join(","),e+=","+new Array($e.size.cols).fill(0).map(function(e,t){return".c"+t}).join(","),n(e).removeClass("hidden")}function Te(){var e;n("#grid .cell").css("width",""),e=n(".row.r0 .cell:not(.hidden)").map(function(){return n(this).width()}).get(),n("#grid .cell").css("width",Math.max.apply(null,e)),n("#tile-container").width(n("#grid").width())}function Ae(){var e=n("#c-0-0").width();n(".tile").width(e)}function Se(){et.forEach(function(e,t){e.forEach(function(e,n){0!==e&&v(z.newTileAt(t,n,e),t,n)})}),je&&v(je,tt,nt)}function we(){et.forEach(function(e,t){e.forEach(function(e,n){0!==e&&v(z.get(t,n),t,n)})}),je&&v(je,tt,nt)}function ye(){lt=n(e).width(),ft=n(e).height(),Te(),Ae(),we()}function Ee(){lt=n(e).width(),ft=n(e).height(),z.hideAll(),ve(),Te(),Ae(),We.text(Qe.level),Be.text(Qe.score),Ze.text(Qe.best),T(Ke,it)}function Ne(){M.hasSavedGame($e)?Qe=M.loadStats($e):Qe.best=0,Qe.level=0,Qe.score=0,Qe.isNewBest=!0,Qe.prevBest=Qe.best,M.saveStats($e,Qe),et=function(e,t){var n,o,i,a=[];for(o=0;o<e;++o){for(n=[],i=0;i<t;++i)n.push(0);a.push(n)}return a}($e.size.rows,$e.size.cols),gt.init(),it=gt.getNext(),Ee(),bt=function(){requestAnimationFrame(function(){Ct=Ot.PLAYING,k(),M.incTimesPlayed($e)})},0===M.loadTimesPlayed($e)?(Ct=Ot.WAITING,requestAnimationFrame(function(){function e(){requestAnimationFrame(function(){n(".instruction-screen.ingame-screen").hide(),Tt=setTimeout(bt,200)})}function t(){n("#instruction-screen-0").hide(),n("#instruction-screen-1").show(),n("#ok-button-1").off(L).on(L,e)}n("#instruction-screen-0").show(),n("#ok-button-0").off(L).on(L,function(){0===M.loadTotalTimesPlayed()?requestAnimationFrame(t):e()})})):Tt=setTimeout(bt,D)}function Ie(){var e;e=M.loadTiles($e),et=M.loadGrid($e),Qe=M.loadStats($e),ot=e.tile,it=e.next,tt=e.row,nt=e.col,gt.load(),Ee(),requestAnimationFrame(function(){je=z.newTile(ot),Se(),S(je)}),O()?(bt=function(){Ct=Ot.PLAYING,fe()},Tt=setTimeout(bt,2*D)):requestAnimationFrame(function(){Pe(!0)})}function Me(){(zt=o.running.slice()).forEach(function(e){e.pause()})}function Le(){zt.forEach(function(e){e.play()}),zt=[]}function be(){Me(),zt=[],je&&(je[0].style.opacity="")}function Ge(){n("#game .ingame-screen").hide(),be(),Ct=Ot.STARTING,M.hasSavedGame($e)?Ie():Ne()}function Oe(){be(),Ct=Ot.STARTING,Ne()}function Ce(){Me(),clearTimeout(Tt),Ct!==Ot.STARTING&&Ct===Ot.PLAYING&&(Ct=Ot.PAUSED)}function ze(){Le(),Ct!==Ot.STARTING?Ct===Ot.PAUSED&&(ut||(ct.restart(),Tt=setTimeout(fe,2*A())),Ct=Ot.PLAYING):Tt=setTimeout(bt,D)}function Pe(e){var t;w(je),(t=n("#game-over > .msg").hide()).eq(Math.floor(Math.random()*t.length)).show(),n("#msg-container > .msg").hide(),Qe.prevBest<Qe.best?t=n("#msg-container > .high-score"):(t=n("#msg-container > .share"),Math.random()<.5&&t.add("#msg-container > .like")),t.eq(Math.floor(Math.random()*t.length)).show(),n("#speed-container span").addClass("hidden").filter('[data-option="'+$e.speed+'"]').removeClass("hidden"),n("#mode-container span").addClass("hidden").filter('[data-option="'+$e.mode+'"]').removeClass("hidden"),e?n("#end-screen").show():ge("shake-hor",function(){n("#end-screen").fadeIn()}),Ct=Ot.ENDED}function De(e,t){Gt.shutdown(),(Gt=e).create(t)}function Ye(e){De(Yt,e)}function Re(e){De(Ft,e)}function Fe(e){De(Dt,e)}function xe(e){De(Rt,e)}function ke(e){n(t).on("backbutton",e)}function _e(e){n(t).off("backbutton",e)}function qe(){Gt===Rt?Gt.goToOptions():Gt===Ft&&Gt.goToGame()}function Ve(){requestAnimationFrame(qe)}function Xe(){}function He(e,t){requestAnimationFrame(function(){var o=n(e),i=o.removeClass("selected").prev();0===i.length&&(i=o.parent().children().last()),i.addClass("selected"),st[t]=i.data("option"),c()})}function Ue(e,t){requestAnimationFrame(function(){var o=n(e),i=o.removeClass("selected").next();0===i.length&&(i=o.parent().children().first()),i.addClass("selected"),st[t]=i.data("option"),c()})}function Je(){requestAnimationFrame(function(){n("#end-screen, #confirm-screen").hide(),ge(Math.random()<.5?"shake":"shake-rot",Oe)})}var je,We=n("#level"),Be=n("#score"),Ze=n("#best"),Ke=n("#next"),Qe={level:0,score:0,best:0,prevBest:0,isNewBest:!1},$e={mode:-1,speed:-1,size:{rows:-1,cols:-1}},et=[],tt=0,nt=0,ot=1,it=1,at=0,rt=function(){function e(){t=-1,s()}var t=-1;return function(){-1===t&&(t=setTimeout(e,100))}}(),st=M.loadSettings();null===st?(st={altControls:parseInt(n("#controls input:checked").val(),10),sensitivity:n("#sensitivity-list .sensitivity.selected").data("option"),size:n("#sizes .size.selected").data("option"),speed:n("#speeds .speed.selected").data("option")},M.saveSettings(st)):(n('#controls input[value="'+st.altControls+'"]').prop("checked",!0),f(n("#sensitivity-list .sensitivity"),st.sensitivity),f(n("#sizes .size"),st.size),f(n("#speeds .speed"),st.speed)),n("#options input").change(function(){switch(this.name){case"controls":st.altControls=parseInt(n("#controls input:checked").val(),10);break;default:st[this.name]=this.checked}c()});var ct,ut,lt,ft,dt,ht,pt,mt,gt=function(){function e(e,t,n){var i,a,s=t.length;for(i=0;i<s;++i)for(a=0;a<o;++a)e[i*o+a]=t[i];r(e)}function t(t,n){return a.index===a.bag.length&&(e(a.bag,t,n),a.index=0),a.bag[a.index++]}function n(){switch($e.mode){case E.EVIL:i=Y.EVIL;break;case E.FILTHY:i=Y.FILTHY;break;case E.DIRTY:i=Y.DIRTY;break;default:case E.CLEAN:i=Y.CLEAN}o=$e.size.cols-1}var o,i,a={bag:[],index:0};return{init:function(){n(),a.bag=new Array(i.length*o),e(a.bag,i,void 0),a.index=Math.floor(Math.random()*(o-2)),this.save()},load:function(){a=M.loadRngState($e),n()},save:function(){M.saveRngState($e,a)},getNext:function(){var e=this;return setTimeout(function(){e.save()}),t(i,void 0)}}}(),vt={targets:null,opacity:.5,duration:500,easing:"linear",direction:"alternate",loop:!0},Tt=-1,At={PULSE:{scale:[{value:.86,duration:75},{value:1.16,duration:150},{value:1,duration:75}],easing:{EASE:[.25,.1,.25,1]}.EASE,duration:300},CLEAR:{scale:[{value:1.2,duration:125},{value:0,duration:375}],rotate:[{value:720,duration:375,delay:125}],easing:"linear",duration:500}},St=function(){var e={targets:null,translateX:0,translateY:0,scale:At.PULSE.scale,easing:At.PULSE.easing,duration:At.PULSE.duration,complete:null};return G&&(e.translateZ=0),function(t,n,i){var a=T(z.get(t,n),et[t][n])[0];e.targets=a,e.translateX=o.getValue(a,"translateX"),e.translateY=o.getValue(a,"translateY"),e.complete=i,o(e)}}(),wt=[],yt=function(){function e(e){var t=e.row,n=e.col,o=et.length-1;for(t=e.row+1;t<o&&!y(t+1,n);++t)et[t][n]=et[t+1][n],z.update(t+1,n,t,n);et[t][n]=0}return function(){wt.forEach(e),wt=[],q()}}(),Et=function(){function e(e,t,n){et[e][t]+=et[e+1][t],z.hideAt(e,t),z.update(e+1,t,e,t),St(e,t,n)}return function(){for(var t=0,n=wt.length-1;t<n;++t)e(wt[t].row,wt[t].col);e(wt[t].row,wt[t].col,yt)}}(),Nt=function(){function e(e){var t=e.col,n=e.row+1,o=et.length;do{g(z.get(n,t),n-1,t,P)}while(++n<o&&!y(n,t))}function t(e){var t,n=e.col,o=e.row+1,i=et.length;do{(o+1===i||y(o+1,n))&&(t=Et),g(z.get(o,n),o-1,n,P,t)}while(++o<i&&!y(o,n))}return function(){for(var n=0,o=wt.length-1;n<o;++n)e(wt[n]);t(wt[wt.length-1])}}(),It=[],Mt=function(){function e(e,n,i){var a=z.get(e,n)[0];t.targets=a,t.complete=i,t.translateX=o.getValue(a,"translateX"),t.translateY=o.getValue(a,"translateY"),o(t)}var t={targets:null,translateX:0,translateY:0,scale:At.CLEAR.scale,rotate:At.CLEAR.rotate,easing:At.CLEAR.easing,duration:At.CLEAR.duration,complete:null};return G&&(t.translateZ=0),function(){var t,n,o,i,a;for(t=0,o=It.length-1;t<o;++t)for(n=It[t],i=0,a=et[0].length;i<a;++i)e(n,i);for(n=It[t],i=0,a=et[0].length-1;i<a;++i)e(n,i);e(n,i,U)}}(),Lt=function(){function e(e,t){m(e)&&It.push(t)}return function(){et.forEach(e),It.length>0?Mt():k()}}();n(t).keydown(function(e){switch(e.which){case 80:e.preventDefault(),Ve()}}),n(e).resize(function(){Gt!==Rt&&Gt!==Ft||requestAnimationFrame(ye)});var bt,Gt,Ot=Object.freeze({WAITING:0,STARTING:1,PLAYING:2,PAUSED:3,ENDED:4}),Ct=Ot.PAUSED,zt=[],Pt={goToOptions:Xe,goToMainMenu:Xe,goToGame:Xe,goToOther:Xe,create:Xe,shutdown:Xe},Dt=n.extend({},Pt,{selector:"",goToMainMenu:function(){n(Dt.selector).css("display","none"),_e(Dt.goToMainMenu),Ye()},create:function(e){Dt.selector="#"+e,n(Dt.selector).css("display","block"),ke(Dt.goToMainMenu)}}),Yt=n.extend({},Pt,{goToOther:function(e){n("#main-menu").hide(),Fe(e)},goToGame:function(){n("#main-menu").hide(),xe()},create:function(){n("#main-menu").show()}}),Rt=n.extend({},Pt,{goToMainMenu:function(){Ce(),me(),n("#game").hide(),Ye()},goToOptions:function(){n("#confirm-screen").hide(),Ce(),Re()},create:function(e){e||(n("#game").show(),pe(),Ge()),ke(Rt.goToOptions)},shutdown:function(){_e(Rt.goToOptions)}}),Ft=n.extend({},Pt,{goToMainMenu:function(){xe(!0),Rt.goToMainMenu()},goToGame:function(){xe(!0),ze()},create:function(){n("#options").show(),n("#pause-resume-button").removeClass("pause").addClass("resume"),ke(Ft.goToGame)},shutdown:function(){st=M.loadSettings(),_e(Ft.goToGame),n("#options").hide(),n("#pause-resume-button").removeClass("resume").addClass("pause")}});Gt=Yt,n("#pause-resume-button").on(L,Ve),n("#other button").on(L,function(){var e=this.name;requestAnimationFrame(function(){Gt.goToOther(e)})}),n("#size-left").on(L,function(){He("#sizes .size.selected","size")}),n("#size-right").on(L,function(){Ue("#sizes .size.selected","size")}),n("#speed-left").on(L,function(){He("#speeds .speed.selected","speed")}),n("#speed-right").on(L,function(){Ue("#speeds .speed.selected","speed")}),n("#sensitivity").on(L,function(){Ue("#sensitivity-list .sensitivity.selected","sensitivity"),he()}),n(".play-button").on(L,function(){var e=n("#sizes .size.selected").data("option").split("x"),t=this,o=$e.size.cols;$e.mode=n(this).data("mode"),$e.speed=n("#speeds .speed.selected").data("option"),$e.size.rows=+e[0],$e.size.cols=+e[1],requestAnimationFrame(function(){n("#game .mode").addClass("hidden"),n("#game ."+t.id).removeClass("hidden"),n("#grid, #tile-container").removeClass("col"+o).addClass("col"+$e.size.cols),0===$e.speed?n("#game .speed.classic").removeClass("hidden"):n("#game .speed.classic").addClass("hidden"),Gt.goToGame()})}),n(".menu-button").on(L,function(){requestAnimationFrame(function(){Gt.goToMainMenu()})}),n("#new-game-button").on(L,function(){Gt===Ft&&Gt.goToGame(),Ct!==Ot.WAITING&&(Ct!==Ot.ENDED?(Ce(),requestAnimationFrame(function(){n("#confirm-screen").show()})):Je())}),n("#confirm-screen .yes").on(L,Je),n("#confirm-screen .no").on(L,function(){requestAnimationFrame(function(){n("#confirm-screen").hide(),ze()})}),n("#restart-button").on(L,Je),Gt.create(),n(e).blur(function(){Gt===Rt&&Ct!==Ot.ENDED&&Gt.goToOptions()})}()}(window,document,Zepto,anime);